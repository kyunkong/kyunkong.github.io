<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/colorful.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <!-- <link rel="icon" href="/favicon.ico" type="image/x-icon"> -->
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>python - Fung's wiki</title>
    <!-- <meta name="keywords" content=""/> -->
    <!-- <meta name="description" content=""/> -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  </head>

  <body>
    <div id="container" class="typo">
      
<div id="header">
  <div id="post-nav">
    <a href="/">Fung's wiki</a>
    &nbsp;&#187;&nbsp;
    <a href="/#misc">misc</a>
    &nbsp;&#187;&nbsp;python
    <span class="updated">Last Update: &nbsp;
    2018-01-17 12:19:56
    </span>
  </div>
</div>
<div class="clearfix"></div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#upgrade-python26-to-python27-without-disrupting-existing-one">Upgrade python2.6 to python2.7 without disrupting existing one</a></li>
<li><a href="#how-to-upgrade-python-in-centosrhel-6">How to upgrade python in Centos/RHEL 6</a></li>
<li><a href="#install-pip-in-ubuntu">install pip in ubuntu</a></li>
<li><a href="#sysexit-code-on-python">sys.exit() code on python:</a></li>
<li><a href="#ipython-reloadauto-load-customize-module">ipython reload/auto-load customize module</a></li>
<li><a href="#function-source-code">Function source code</a></li>
<li><a href="#python-tutorial">Python tutorial</a></li>
<li><a href="#comprehensions-syntax">comprehensions syntax</a></li>
<li><a href="#help-from-python">Help from python</a></li>
<li><a href="#file-operations">File operations</a></li>
<li><a href="#catching-exception">Catching exception</a></li>
<li><a href="#try-finally">try-finally</a></li>
<li><a href="#raising-exception">Raising exception</a></li>
<li><a href="#list-method-return-values">list method return values</a></li>
</ul>
</div>
<h2 id="upgrade-python26-to-python27-without-disrupting-existing-one">Upgrade python2.6 to python2.7 without disrupting existing one</h2>
<p>download latest python2.7 version source</p>
<div class="hlcode"><pre><span class="n">yum</span> <span class="n">install</span> <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span>
<span class="n">yum</span> <span class="n">install</span> <span class="n">zlib</span><span class="o">-</span><span class="n">devel</span>
<span class="n">tar</span> <span class="n">xvf</span> <span class="n">Python</span><span class="o">-</span><span class="mf">2.7.13</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">xz</span>
<span class="n">cd</span> <span class="n">Python</span><span class="o">-</span><span class="mf">2.7.13</span>
<span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">shared</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">altinstall</span>
</pre></div>


<p><strong>Make a link to python library path</strong></p>
<div class="hlcode"><pre><span class="c">#On 64 bit OS</span>
<span class="c"># ldd `python2.7` to check the dependency</span>
ln -s /usr/local/lib/libpython2.7.so.1.0 /usr/lib64/libpython2.7.so.1.0
<span class="c">#for python3.6</span>
ln -s /usr/local/lib/libpython3.6m.so.1.0 /usr/lib64/libpython3.6m.so.1.0
</pre></div>


<p><strong>Install pip from get-pip.py</strong></p>
<div class="hlcode"><pre><span class="n">curl</span>  <span class="n">https</span><span class="o">:</span><span class="c1">//bootstrap.pypa.io/get-pip.py</span>
<span class="n">python2</span><span class="mf">.7</span> <span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<p>https://ruiaylin.github.io/2014/12/12/python%20update/<br />
https://github.com/h2oai/h2o-2/wiki/installing-python-2.7-on-centos-6.3.-follow-this-sequence-exactly-for-centos-machine-only<br />
http://www.javavirtues.com/2016/12/installing-python-on-linux-without.html</p>
<h2 id="how-to-upgrade-python-in-centosrhel-6">How to upgrade python in Centos/RHEL 6</h2>
<ul>
<li>Download the source  code </li>
<li>Configure it </li>
</ul>
<div class="hlcode"><pre><span class="nb">cd </span>source_dir
.configure
</pre></div>


<ul>
<li>Make &amp;&amp; make install </li>
</ul>
<div class="hlcode"><pre>make <span class="o">&amp;&amp;</span> make install
</pre></div>


<p>Because yum in RHEL6 is depend on python2.6, so still need to change the head file in yum configuration, so do not remove old python version </p>
<div class="hlcode"><pre>mv /usr/bin/python /usr/bin/python2.6.6
ln -s /usr/local/bin/python2.7 /usr/bin/python
</pre></div>


<div class="hlcode"><pre>vim /usr/bin/yum
<span class="c">#subtitute python to python2.6.6 in sha-bang</span>
!/usr/bin/python2.6.6
</pre></div>


<h2 id="install-pip-in-ubuntu">install pip in ubuntu</h2>
<ul>
<li>install python2 pip</li>
</ul>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span>
</pre></div>


<ul>
<li>install python3 pip</li>
</ul>
<div class="hlcode"><pre><span class="n">wget</span> <span class="n">https</span><span class="o">:</span><span class="c1">//bootstrap.pypa.io/get-pip.py</span>
<span class="n">sudo</span> <span class="n">python3</span> <span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="p">.</span><span class="n">py</span>
</pre></div>


<h2 id="sysexit-code-on-python">sys.exit() code on python:</h2>
<div class="hlcode"><pre><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">asm</span><span class="o">-</span><span class="n">generic</span><span class="o">/</span><span class="n">errno</span><span class="p">.</span><span class="n">h</span>
</pre></div>


<h2 id="ipython-reloadauto-load-customize-module">ipython reload/auto-load customize module</h2>
<p>On the ipython interpreter, if you want to import your owner module every time after ipython started up, and want to reload the module after you modified the module without re-open the ipython,  just do some configurations on the ipython profile.<br />
* 1. Create the ipython profile</p>
<div class="hlcode"><pre>    <span class="n">ipython</span> <span class="n">profile</span> <span class="n">create</span>
</pre></div>


<ul>
<li>
<ol>
<li>Edit the profile</li>
</ol>
</li>
</ul>
<div class="hlcode"><pre>    <span class="n">vi</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">fung</span><span class="o">/</span><span class="p">.</span><span class="n">ipython</span><span class="o">/</span><span class="n">profile_default</span><span class="o">/</span><span class="n">ipython_config</span><span class="p">.</span><span class="n">py</span>
    <span class="n">c</span><span class="p">.</span><span class="n">InteractiveShellApp</span><span class="p">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">autoreload</span><span class="err">&#39;</span><span class="p">]</span>                      <span class="err">#</span><span class="k">for</span> <span class="k">auto</span> <span class="n">reload</span> <span class="n">module</span>
    <span class="n">c</span><span class="p">.</span><span class="n">InteractiveShellApp</span><span class="p">.</span><span class="n">exec_lines</span> <span class="o">=</span> <span class="p">[</span><span class="err">&#39;</span><span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span><span class="err">&#39;</span><span class="p">]</span>                   <span class="err">#</span><span class="k">for</span> <span class="k">auto</span> <span class="n">reload</span> <span class="n">module</span>
    <span class="n">c</span><span class="p">.</span><span class="n">InteractiveShellApp</span><span class="p">.</span><span class="n">exec_lines</span> <span class="o">=</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">from</span> <span class="n">tutorial</span><span class="p">.</span><span class="n">myModule</span> <span class="n">import</span> <span class="o">*</span><span class="err">&#39;</span><span class="p">]</span> <span class="err">#</span><span class="k">for</span> <span class="k">auto</span> <span class="n">import</span> <span class="n">the</span> <span class="n">module</span>
</pre></div>


<ul>
<li>
<ol>
<li>Ipython command line to reload a module</li>
</ol>
</li>
</ul>
<div class="hlcode"><pre>    <span class="c">%load_ext autoreload</span>
    <span class="c">%autoreload 2</span>
</pre></div>


<h2 id="function-source-code">Function source code</h2>
<div class="hlcode"><pre><span class="nx">In</span> <span class="cp">[</span><span class="mi">34</span><span class="cp">]</span><span class="o">:</span> <span class="nx">p99</span><span class="o">??</span>
<span class="nx">Signature</span><span class="o">:</span> <span class="nx">p99</span><span class="p">()</span>
<span class="nx">Source</span><span class="o">:</span>   
<span class="nx">def</span> <span class="nx">p99</span><span class="p">()</span><span class="o">:</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">:</span>
        <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span>
            <span class="nx">print</span><span class="p">(</span><span class="s1">&#39;{}*{}={}\t&#39;</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">,</span><span class="nx">i</span><span class="o">*</span><span class="nx">j</span><span class="p">),</span> <span class="nx">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nx">print</span><span class="p">()</span>
<span class="nx">File</span><span class="o">:</span>      <span class="o">~</span><span class="err">/workspace/tutorial/myModule.py</span>
<span class="nx">Type</span><span class="o">:</span>      <span class="kd">function</span>
</pre></div>


<h2 id="python-tutorial">Python tutorial</h2>
<p>https://pythonspot.com/en/</p>
<h2 id="comprehensions-syntax">comprehensions syntax</h2>
<div class="hlcode"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">return</span> <span class="p">[</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">result:</span>
<span class="sd">In [28]: power3(10)</span>
<span class="sd">Out[28]: [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="p">[</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>    <span class="c">#list comprehensions</span>
<span class="p">(</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>    <span class="c">#generator comprehensions</span>
<span class="p">{</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">}</span>    <span class="c">#set comprehensions</span>
<span class="p">{</span> <span class="n">k</span><span class="p">:</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">}</span>   <span class="c">#dict comprehensions</span>
</pre></div>


<h2 id="help-from-python">Help from python</h2>
<div class="hlcode"><pre><span class="cp">#1. from command line:</span>
<span class="n">pydoc</span> <span class="n">Module_name</span>

<span class="cp">#2. from intepreter:</span>
<span class="n">Module_name</span><span class="p">.</span><span class="n">__doc__</span>
<span class="n">or</span>
<span class="n">help</span><span class="p">(</span><span class="n">Module_name</span><span class="p">)</span>
<span class="n">or</span>
<span class="n">print</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">__doc__</span><span class="p">)</span>
</pre></div>


<h2 id="file-operations">File operations</h2>
<div class="hlcode"><pre><span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">myfile</span><span class="err">&#39;</span><span class="p">,</span> <span class="sc">&#39;w&#39;</span><span class="p">)</span>       <span class="err">#</span><span class="n">open</span> <span class="n">file</span> <span class="err">&#39;</span><span class="n">myfile</span><span class="err">&#39;</span> <span class="k">for</span> <span class="n">write</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="err">&#39;</span><span class="n">This</span> <span class="n">is</span> <span class="n">the</span> <span class="n">first</span> <span class="n">line</span><span class="err">\</span><span class="n">n</span><span class="err">&#39;</span><span class="p">)</span>       <span class="err">#</span><span class="n">write</span> <span class="n">a</span> <span class="n">line</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>                     <span class="err">#</span><span class="n">Close</span> <span class="n">the</span> <span class="n">file</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">myfile</span><span class="err">&#39;</span><span class="p">,</span> <span class="sc">&#39;r&#39;</span><span class="p">)</span>        <span class="err">#</span><span class="n">open</span> <span class="n">file</span> <span class="k">for</span> <span class="n">read</span>
<span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>                      <span class="err">#</span><span class="n">read</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">file</span>
<span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>                 <span class="err">#</span> <span class="n">read</span> <span class="n">entire</span> <span class="n">file</span> <span class="n">at</span> <span class="n">once</span>
<span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>                  <span class="err">#</span> <span class="n">read</span> <span class="n">a</span> <span class="n">line</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">myfile</span><span class="err">&#39;</span><span class="p">,</span> <span class="sc">&#39;a&#39;</span><span class="p">)</span>       <span class="err">#</span><span class="n">append</span> <span class="n">a</span> <span class="n">file</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;this is second line</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<h2 id="catching-exception">Catching exception</h2>
<div class="hlcode"><pre><span class="n">def</span> <span class="n">division</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">:</span>
   <span class="nl">try:</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="c1">// b)</span>
   <span class="n">except</span> <span class="n">ZeroDivisionError</span><span class="o">:</span>
      <span class="n">print</span><span class="p">(</span><span class="s">&quot;Non-zero number needed&quot;</span><span class="p">)</span>
</pre></div>


<h2 id="try-finally">try-finally</h2>
<div class="hlcode"><pre><span class="n">def</span> <span class="n">test</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">:</span>
   <span class="nl">try:</span>
      <span class="n">fin</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">file</span><span class="err">&#39;</span><span class="p">,</span> <span class="sc">&#39;W&#39;</span><span class="p">)</span>
   <span class="nl">finally:</span>
      <span class="n">fin</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
   <span class="n">except</span> <span class="n">IOError</span><span class="o">:</span>
      <span class="n">print</span><span class="p">(</span><span class="s">&quot;No such file or directory&quot;</span><span class="p">)</span>
</pre></div>


<h2 id="raising-exception">Raising exception</h2>
<div class="hlcode"><pre><span class="n">def</span> <span class="n">fun1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">:</span>
   <span class="k">if</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="o">:</span>
      <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Invalid number:&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>


<h2 id="list-method-return-values">list method return values</h2>
<p>tuples are similar with list, except that once tuple is created, you can not <br />
modify it by adding, deleting, replacing or reordering items</p>
<div class="hlcode"><pre><span class="n">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>   <span class="err">#</span><span class="n">append</span> <span class="mi">11</span> <span class="n">to</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>     <span class="err">#</span><span class="n">List</span> <span class="n">how</span> <span class="n">many</span> <span class="n">times</span> <span class="n">the</span> <span class="mi">3</span> <span class="n">number</span> <span class="n">in</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span> <span class="err">#</span><span class="n">merge</span> <span class="n">list2</span> <span class="n">to</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>        <span class="err">#</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="k">return</span> <span class="n">the</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">occurrence</span> <span class="n">of</span> <span class="n">element</span> <span class="n">x</span> <span class="n">in</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>   <span class="err">#</span><span class="n">insert</span> <span class="mi">12</span> <span class="n">to</span> <span class="n">the</span> <span class="n">first</span> <span class="n">position</span> <span class="n">of</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>       <span class="err">#</span><span class="n">remove</span> <span class="n">the</span> <span class="n">first</span> <span class="n">occurrence</span> <span class="n">of</span> <span class="n">element</span> <span class="n">x</span> <span class="n">and</span> <span class="k">return</span> <span class="n">None</span>
<span class="n">list</span><span class="p">.</span><span class="n">reverse</span><span class="p">()</span>       <span class="err">#</span><span class="n">reverse</span> <span class="n">the</span> <span class="n">list</span>
<span class="n">list</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>          <span class="err">#</span><span class="n">remove</span> <span class="n">the</span> <span class="n">element</span> <span class="n">at</span> <span class="n">the</span> <span class="n">given</span> <span class="n">position</span> <span class="n">and</span> <span class="k">return</span> <span class="n">it</span>
<span class="n">list</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>          <span class="err">#</span><span class="n">sort</span> <span class="n">the</span> <span class="n">list</span> <span class="n">and</span> <span class="k">return</span> <span class="n">none</span>
</pre></div>
  
</div>
    </div>
    <div id="footer">
      <!-- <div class="footer-left"> -->
      <!-- <div class="footer-center"> -->
        <center>
        <p>
        Copyright © 2012-2018 Fung Kong.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
        Theme by <a href="https://github.com/tankywoo/yasimple_x2" target="_blank">YASimple_X2</a>.
        </p>
        </center>
      <!-- </div> [> end footer-left <] -->
      <!-- <div class="footer-right"> -->
        <!-- <p>站点最后生成 2018-01-26 17:11:07</p> -->
      <!-- </div> [> end footer-right <] -->
    </div>

    
    

  </body>
</html>